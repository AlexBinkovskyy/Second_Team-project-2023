{"version":3,"file":"commonHelpers.js","sources":["../src/js/shopping-cart.js","../src/js/cartmodalwindow.js"],"sourcesContent":["import { getProdByIDWithParams } from './query';\nimport icons from '../images/sprite.svg';\nimport { getCartItems } from './localStorage';\nimport {\n  addProductToCart,\n  setEmailToOrderInfo,\n  removeAllProductsFromCart,\n  removeProductFromCart,\n} from './workWithCart';\n\nconst list = document.querySelector('.js-cart-list');\nconst formInput = document.querySelector('.cart-form-input');\nconst summ = document.querySelector('.js-total-summ');\nconst cartNumbersList = document.querySelectorAll('.js-cart-numbers');\nconst clearOrderBtn = document.querySelector('.js-clear-order-btn');\n\nconst cartBox = document.querySelector('.js-cart-box');\nconst emptyCart = document.querySelector('.js-empty-cart');\n\n\nsetEmailToOrderInfo('p@gmail.com');\n\nlet arrCart = getCartItems();\nlet totalSumm = 0;\ndrawCartPage();\n\nlist.addEventListener('click', e => {\n  if (e.target.classList.contains('delete-btn')) {\n    let parent = e.target.closest('.selectedProduct');\n    // console.log(parent);\n    removeProductFromCart(parent.dataset.id);\n    drawCartPage();\n  }\n});\n\nasync function drawCartPage() {\n  //масив з localStorage\n  arrCart = getCartItems();\n  // console.log(arrCart);\n\n  summ.textContent = '$0';\n\n  const amountElements = arrCart.products.length;\n  switchSections(amountElements);\n\n  if (amountElements) {\n    list.innerHTML = '';\n    //масив з Серверу\n    const originProductList = await getCartProducts(arrCart.products);\n    // console.log(originProductList);\n\n    cartNumbersUpdate(cartNumbersList, amountElements);\n    // console.log(cartBox);\n    spawnCardProducts(originProductList);\n    summ.textContent = '$' + getTotalSumm(originProductList);\n  }\n  \n  // updateCartBasket();\n  formInput.value = arrCart.email;\n}\n\nclearOrderBtn.addEventListener('click', () => {\n  removeAllProductsFromCart();\n  drawCartPage();\n});\n\nfunction spawnCardProducts(products) {\n  generateCardListMarkup(products, createCartProductMarkup).then(result => {\n    list.insertAdjacentHTML('beforeend', result);\n  });\n}\n\n/*  Параметри:\n      1.productList - масив з продуктами      \n        [{\n          id: '640c2dd963a319ea671e383b',\n          amount: 1,\n        }]\n\n      2.createElementMarkupFunc - Функція, що створює потрібну вам розмітку елемента.\n\n    Повертає html розмітку продуктів\n===================================================================================== */\nasync function generateCardListMarkup(productList, createElementMarkupFunc) {\n  return productList\n    .map(product => {\n      totalSumm += product.price;\n      return createElementMarkupFunc(product);\n    })\n    .join('');\n}\n\n/*  Параметри:\n      1.productList - масив з продуктами      \n        [{\n          id: '640c2dd963a319ea671e383b',\n          amount: 1,\n        }]\n\n    Повертає масив даних з продуктів\n===================================================================================== */\nasync function getCartProducts(productList) {\n  return await Promise.all(\n    productList.map(({ id }) =>\n      getProdByIDWithParams(id).then(rqst => rqst.data)\n    )\n  );\n}\n\n// створення карттки в кошику\nfunction createCartProductMarkup(product) {\n  const { _id, name, img, category, price, size } = product;\n  const cleanedCategory = category.replace(/_/g, ' ');\n\n  return `\n    <li class=\"selectedProduct\" data-id=${_id}>\n      <div class=\"product-picture\">\n          <img src=\"${img}\" alt=\"${name}\" class=\"\" loading=\"lazy\" />\n      </div>\n\n      <div class=\"product-info-container\">\n\n      <div class=\"info-header\">\n        <h2 class=\"product-name\">${name}</h2>\n        <button class=\"delete-btn\">\n\n          <svg class=\"\" width=\"11.25\" height=\"11.25\">\n\n            <use href=\"${icons}#icon-Cross_close\"></use>\n          </svg>\n        </button>\n      </div>\n\n      <div class=\"product-info\">\n        <p class=\"info-quality-category\"> Category: <span class=\"info-value\">${cleanedCategory}</span></p>\n        <p class=\"info-quality\"> Size:<span class=\"info-value\">${size}</span></p>\n      </div>\n        <div class=\"price\">$\n          <span>${price}</span>\n        </div>\n      </div>\n      <div class=\"counter-container\">\n            <button class=\"counter-btn\" type=\"button\" data-action=\"decrement\">\n                -\n            </button>\n            <span class=\"counter-value data-counter\">1</span>\n            <button class=\"counter-btn\" type=\"button\" data-action=\"increment\">\n                +\n            </button>\n        </div>\n  </li>`;\n}\n\n/**\n  |============================\n  | ЛІЧИЛЬНИК\n  |============================\n*/\n\nlet counter;\n\nlist.addEventListener('click', function (event) {\n  // Перевірка кліку сурово по кнопкам + або -\n  if (\n    event.target.dataset.action === 'increment' ||\n    event.target.dataset.action === 'decrement'\n  ) {\n    // Найшли обгортку лічильника\n    const counterContainer = event.target.closest('.counter-container');\n\n    // Найшли значення лічильника\n    counter = counterContainer.querySelector('.counter-value');\n  }\n\n  // Перевірка чи елемент являється кнопкою плюс\n  if (event.target.dataset.action === 'increment') {\n    // Змінює текст в лічильнику, збільшує на 1\n    counter.innerHTML = ++counter.innerHTML;\n  }\n\n  // Перевірка чи елемент являється кнопкою мінус\n  if (event.target.dataset.action === 'decrement') {\n    // Перевірка щоб лічильник був більше або рівний 1\n    if (parseInt(counter.innerHTML) > 1) {\n      // Змінює текст в лічильнику, зменьшує на 1\n      counter.innerHTML = --counter.innerHTML;\n    }\n  }\n});\n\n/**\n  |============================\n  | ДОДАТКОВО ВИДАЛИТЬ ПРОДУКТ ЯКЩО ВІН БУДЕ МЕНШЕ 1\n  |============================\n*/\n// else if (parseInt(counter.innerHTML) === 1) {\n//       // Якщо лічильник дорівнює 1, видалити товар з кошика\n//       let parentEl = event.target.closest('.selectedProduct');\n//       removeProductFromCart(parentEl.dataset.id);\n//       drawCartPage();\n//     }\n\n/**\n  |============================\n  | \n  |============================\n*/\nfunction switchSections(bool) {\n  objHide(cartBox, emptyCart);\n  if (bool) {\n    objShow(cartBox);\n  } else {\n    objShow(emptyCart);\n  }\n}\n\nfunction objShow(...objs) {\n  objs.forEach(obj => {\n    obj.classList.remove('hiden');\n  });\n}\n\nfunction objHide(...objs) {\n  objs.forEach(obj => {\n    obj.classList.add('hiden');\n  });\n}\n\nfunction cartNumbersUpdate(objs, number) {\n  objs.forEach(obj => {\n    obj.textContent = number;\n  });\n}\n\nfunction getTotalSumm(products) {\n  return products.reduce((sum, product) => {\n    console.log(product);\n    return sum + product.price;\n  }, 0);\n}\n","const form = document.querySelector('.cart-form');\nconst modalCloseBtn = document.querySelector('.js-modal-close');\nconst modal = document.querySelector('.cart-modal-bg');\n\n// console.log(\"Modal js\");\n\nform.addEventListener('submit', modalOpen);\nmodalCloseBtn.addEventListener('click', modalClose);\n\nfunction modalOpen(e) {\n  e.preventDefault();\n  modal.classList.remove('hiden');\n}\nfunction modalClose() {\n  modal.classList.add('hiden');\n}\n"],"names":["list","formInput","summ","cartNumbersList","clearOrderBtn","cartBox","emptyCart","setEmailToOrderInfo","arrCart","getCartItems","totalSumm","drawCartPage","e","parent","removeProductFromCart","amountElements","switchSections","originProductList","getCartProducts","cartNumbersUpdate","spawnCardProducts","getTotalSumm","removeAllProductsFromCart","products","generateCardListMarkup","createCartProductMarkup","result","productList","createElementMarkupFunc","product","id","getProdByIDWithParams","rqst","_id","name","img","category","price","size","cleanedCategory","icons","counter","event","bool","objHide","objShow","objs","obj","number","sum","form","modalCloseBtn","modal","modalOpen","modalClose"],"mappings":"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"}